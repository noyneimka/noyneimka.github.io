<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Отзывы - Книжный уголок</title>
    <link rel="stylesheet" href="/css/reviews.css" />
</head>
<body>
    <header>
        <div class="logo-holder">
            <a href="/index.html" id="logo-link">
                <img src="https://i.ibb.co/zTKSMdst/image.png" alt="logo" />
            </a>
            <h1>Отзывы</h1>
            <div class="header-spacer"></div>
        </div>
    </header>
    
    <!-- Кнопка возврата с фиксированным позиционированием -->
    <a href="index.html" class="back-button-fixed">
        <img src="https://i.ibb.co/k2M1GSJh/1.png" alt="Назад" />
    </a>
    
    <main class="container inner-page">
        <!-- Раздел формы для добавления отзывов -->
        <section class="review-form-section">
            <div class="rectangle">
                <h2 class="ztext">Добавить свой отзыв</h2>
                
                <!-- Блок с загрузкой изображения -->
                <div class="avatar-upload">
                    <div class="upload-preview-container">
                        <img id="previewImage" class="avatar-preview" alt="Предпросмотр" />
                        <div class="upload-controls">
                            <label for="image" class="upload-label">
                                Выберите аватарку
                            </label>
                            <input type="file" id="image" accept="image/*" />
                        </div>
                    </div>
                </div>
                
                <!-- Форма для отзывов -->
                <form id="reviewForm" class="review-form">
                    <input type="text" placeholder="Ваше имя" id="name" required class="form-input" />
                    <textarea placeholder="Напишите отзыв" id="message" rows="4" required class="form-textarea"></textarea>
                    
                    <div class="form-buttons">
                        <button type="submit" class="submit-button">Добавить отзыв</button>
                    </div>
                </form>
            </div>
        </section>
        
        <!-- Раздел отзывов -->
        <section class="reviews-section">
            <h2 class="ztext">Отзывы наших посетителей</h2>
            <div class="reviews-container" id="reviewsContainer">
                <!-- Примеры отзывов -->
                <div class="review-card">
                    <img src="https://grizly.club/uploads/posts/2023-08/1693294873_grizly-club-p-kartinki-avatarki-dlya-ds-bez-fona-22.jpg" alt="Павел" class="reviewer-avatar" />
                    <div class="review-content">
                        <div class="ytext">Павел</div>
                        <div class="text">Пересказы очень точные и интересные, идеально для быстрого понимания книги.</div>
                    </div>
                </div>
                <div class="review-card">
                    <img src="https://avatars.mds.yandex.net/i?id=2c673f0a08e986644043783b9c3c20cc2e93ff34-12605172-images-thumbs&n=13" alt="Славения" class="reviewer-avatar" />
                    <div class="review-content">
                        <div class="ytext">Славения</div>
                        <div class="text">Спасибо за отличную работу! Очень помогло подготовиться к экзамену.</div>
                    </div>
                </div>
                <div class="review-card">
                    <img src="https://www.meme-arsenal.com/memes/c7f5e13fb0bd61da28f48d76b090f02a.jpg" alt="Дмитрий" class="reviewer-avatar" />
                    <div class="review-content">
                        <div class="ytext">Дмитрий</div>
                        <div class="text">Классные пересказы, читаются на одном дыхании. Всем советую!</div>
                    </div>
                </div>
                <div class="review-card">
                    <img src="https://encrypted-tbn0.gstatic.com/images?q=tbn:ANd9GcQKD7xbj0jzkfHN0C_Uc9QbGhcIECsAHXNJxfP9f2QzrwOsnTD0oYeTp3L2Z0eKvZyEFek&usqp=CAU" alt="Елена" class="reviewer-avatar" />
                    <div class="review-content">
                        <div class="ytext">Елена</div>
                        <div class="text">Обожаю ваши обзоры! Очень удобно и интересно.</div>
                    </div>
                </div>
                <div class="review-card">
                    <img src="https://hdpic.club/uploads/posts/2022-01/1643004802_5-hdpic-club-p-na-avatarku-mashini-7.jpg" alt="Максим" class="reviewer-avatar" />
                    <div class="review-content">
                        <div class="ytext">Максим</div>
                        <div class="text">Отличный сервис! Спасибо за качественную работу.</div>
                    </div>
                </div>
                <div class="review-card">
                    <img src="https://encrypted-tbn0.gstatic.com/images?q=tbn:ANd9GcRJBywEsmaxMgGYP24mikmuF-CYEshnsvKTEAOErGWwXCTxqYsVuBjpPSvKU3TYs739d88&usqp=CAU" alt="Ольга" class="reviewer-avatar" />
                    <div class="review-content">
                        <div class="ytext">Ольга</div>
                        <div class="text">Очень удобно читать короткие пересказы, экономлю время.</div>
                    </div>
                </div>
                <div class="review-card">
                    <img src="https://encrypted-tbn0.gstatic.com/images?q=tbn:ANd9GcSSL1FdTiLKLZJ7tCKeUt-j6ShhyNZHaDVAUw&s" alt="Андрей" class="reviewer-avatar" />
                    <div class="review-content">
                        <div class="ytext">Андрей</div>
                        <div class="text">Обожаю ваши пересказы! Помогают мне учиться и расширять кругозор.</div>
                    </div>
                </div>
                <div class="review-card">
                    <img src="https://encrypted-tbn0.gstatic.com/images?q=tbn:ANd9GcQKD7xbj0jzkfHN0C_Uc9QbGhcIECsAHXNJxfP9f2QzrwOsnTD0oYeTp3L2Z0eKvZyEFek&usqp=CAU" alt="Наталья" class="reviewer-avatar" />
                    <div class="review-content">
                        <div class="ytext">Наталья</div>
                        <div class="text">Очень понравилось, буду читать ещё и советовать друзьям!</div>
                    </div>
                </div>
            </div>
        </section>
        
        <div class="bottom-spacer"></div>
    </main>
    
    <footer>
        <div class="footer-icons-container">
            <a href="https://t.me/+mVQeuA7PF6g2ZDdi" class="footer-icon-link" title="Следить за нами">
                <!-- Новая иконка Telegram - треугольник -->
                <svg class="footer-icon telegram-icon" viewBox="0 0 24 24" fill="currentColor">
                    <path d="M2,21l20-9L2,3V10l15,2L2,14Z"/>
                </svg>
            </a>
            <a class="footer-icon-link" title="По вопросам" onclick="copyToClipboard('8 800 555 35 55')">
                <!-- Новая иконка телефона -->
                <img src="https://cdn-icons-png.flaticon.com/512/25/25453.png" alt="Телефон" class="footer-icon" />
            </a>
            <a class="footer-icon-link" title="По рекламе" onclick="copyToClipboard('privet@gmail.com')">
                <!-- Новая иконка почты -->
                <img src="https://cdn-icons-png.flaticon.com/512/561/561127.png" alt="Email" class="footer-icon" />
            </a>
            <a href="https://www.sberbank.com/sms/pbpn?requisiteNumber=79195236425" class="footer-icon-link" title="Поддержать нас">
                <!-- Оставляем текущую иконку Сбера -->
                <img src="https://free-png.ru/wp-content/uploads/2020/09/icon_sber-01.png" alt="Сбербанк" class="footer-icon" />
            </a>
        </div>
    </footer>
    
    <!-- Модальное окно для просмотра изображений -->
    <div id="imageModal" class="modal">
        <span class="close-button" onclick="closeModal()">&times;</span>
        <img class="modal-content" id="modalImage" src="" alt="Увеличенное изображение" />
    </div>

    <script>
        // Обработчик формы
        document.getElementById('reviewForm').addEventListener('submit', function(e) {
            e.preventDefault();

            const name = document.getElementById('name').value.trim();
            const message = document.getElementById('message').value.trim();
            const imageInput = document.getElementById('image');
            const container = document.getElementById('reviewsContainer');

            let imgSrc = 'https://via.placeholder.com/80'; // стандартное изображение
            if (imageInput.files && imageInput.files[0]) {
                const reader = new FileReader();
                reader.onload = function(e) {
                    createReview(e.target.result);
                }
                reader.readAsDataURL(imageInput.files[0]);
            } else {
                createReview(imgSrc);
            }

            function createReview(imgSrc) {
                const reviewDiv = document.createElement('div');
                reviewDiv.className = 'review-card';

                const img = document.createElement('img');
                img.src = imgSrc;
                img.alt = 'Отзывчик';
                img.className = 'reviewer-avatar';
                img.onclick = function() {
                    openModal(imgSrc);
                };

                const contentDiv = document.createElement('div');
                contentDiv.className = 'review-content';

                const nameDiv = document.createElement('div');
                nameDiv.className = 'ytext';
                nameDiv.textContent = name;

                const messageDiv = document.createElement('div');
                messageDiv.className = 'text';
                messageDiv.textContent = message;

                contentDiv.appendChild(nameDiv);
                contentDiv.appendChild(messageDiv);

                reviewDiv.appendChild(img);
                reviewDiv.appendChild(contentDiv);

                container.prepend(reviewDiv);

                // Очистить форму после добавления
                document.getElementById('reviewForm').reset();
                document.getElementById('previewImage').style.display = 'none';
                document.getElementById('previewImage').src = '';
                imageInput.value = '';
            }
        });
        
        // Предпросмотр изображения
        const imageInput = document.getElementById('image');
        const previewImage = document.getElementById('previewImage');

        imageInput.addEventListener('change', function() {
            if (this.files && this.files[0]) {
                const reader = new FileReader();
                reader.onload = function(e) {
                    previewImage.src = e.target.result;
                    previewImage.style.display = 'block';
                }
                reader.readAsDataURL(this.files[0]);
            } else {
                previewImage.style.display = 'none';
                previewImage.src = '';
            }
        });
        
        // Функции для модального окна
        function openModal(imageSrc) {
            document.getElementById('modalImage').src = imageSrc;
            document.getElementById('imageModal').style.display = 'flex';
        }
        
        function closeModal() {
            document.getElementById('imageModal').style.display = 'none';
        }
        
        // Функция копирования в буфер обмена
        function copyToClipboard(text) {
            if (navigator.clipboard && navigator.clipboard.writeText) {
                navigator.clipboard.writeText(text)
                    .then(() => showNotification("Скопировано: " + text))
                    .catch(err => fallbackCopyText(text));
            } else {
                fallbackCopyText(text);
            }
        }
        
        function fallbackCopyText(text) {
            const textarea = document.createElement("textarea");
            textarea.value = text;
            document.body.appendChild(textarea);
            textarea.select();
            try {
                const successful = document.execCommand('copy');
                if (successful) {
                    showNotification("Скопировано: " + text);
                } else {
                    showNotification("Не удалось скопировать текст");
                }
            } catch (err) {
                showNotification("Ошибка при копировании: " + err);
            }
            document.body.removeChild(textarea);
        }
        
        // Функция для показа уведомлений
        function showNotification(message) {
            const notification = document.createElement('div');
            notification.className = 'copy-notification';
            notification.textContent = message;
            notification.style.cssText = `
                position: fixed;
                bottom: 100px;
                left: 50%;
                transform: translateX(-50%);
                background-color: rgba(0, 0, 0, 0.8);
                color: white;
                padding: 12px 24px;
                border-radius: 8px;
                z-index: 9999;
                font-size: 16px;
                text-align: center;
                animation: fadeInOut 3s ease;
            `;
            
            const style = document.createElement('style');
            style.textContent = `
                @keyframes fadeInOut {
                    0% { opacity: 0; transform: translateX(-50%) translateY(20px); }
                    15% { opacity: 1; transform: translateX(-50%) translateY(0); }
                    85% { opacity: 1; transform: translateX(-50%) translateY(0); }
                    100% { opacity: 0; transform: translateX(-50%) translateY(-20px); }
                }
            `;
            document.head.appendChild(style);
            
            document.body.appendChild(notification);
            
            setTimeout(() => {
                notification.remove();
                style.remove();
            }, 3000);
        }
        
        // Закрытие модального окна при клике вне изображения
        document.getElementById('imageModal').addEventListener('click', function(e) {
            if (e.target === this) {
                closeModal();
            }
        });
        
        // Закрытие модального окна клавишей ESC
        document.addEventListener('keydown', function(e) {
            if (e.key === 'Escape') {
                closeModal();
            }
        });
        
        // Добавляем обработчик клика на все аватары для открытия в модальном окне
        document.addEventListener('DOMContentLoaded', function() {
            const avatars = document.querySelectorAll('.reviewer-avatar');
            avatars.forEach(avatar => {
                avatar.addEventListener('click', function() {
                    openModal(this.src);
                });
            });
        });
    </script>
</body>
</html>